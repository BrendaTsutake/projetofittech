<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
    @font-face {
        font-family: "Louis George Cafe";
        src: url(fontes/louis_george_cafe/Louis\ George\ Cafe\ Light.ttf) format("truetype");
    }


    @font-face {
    font-family: "mousse";
    src:
    url("fontes/mousse/Mousse-Regular.otf") format("otf");
    }

        
    body {
        font-family: 'Louis George Cafe', Arial, sans-serif;
        font-weight: 500; 
        font-size: 30px;
        background-color: #FFF9EA;
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .logo {
        text-align: center;
        margin-top: 0;
        width: 250px;
        height: 100px;
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        margin-left: auto;
        margin-right: auto;
        margin-bottom: 50px;
    }

    .botao {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 16px;
        margin-top: 20px;
        width: auto;
        margin-left: 111px;
    }

    .botao button {
        background-color: #9EC662;
        color: #FFF9EA;
        border: none;
        padding: 14px 32px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 23px;
        box-shadow: 0 6px 10px rgba(0, 0, 0, 0.16);
        font-family: 'Louis George Cafe', Arial, sans-serif;
        font-weight: 500; 
    }

    .titulo p {
        text-align: center;
        font-size: 50px;
        margin-top: 80px;
        color: #F8694D;
        font-family: 'mousse', Arial, sans-serif;
        }

    .cadastro-form {
        text-align: center;
        background-color: #9ec6626f;
        border-radius: 8px;
        width: 600px;
        height: auto;
    }


    .cadastro-form form > div:not(.botao) {
        width: 290px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        margin: 10px 0 0 0;
    }

    .cadastro-form label {
        margin-bottom: 6px;
    }

    .cadastro-form input[type="text"],
    .cadastro-form input[type="password"],
    .cadastro-form input[type="email"],
    .cadastro-form input[type="tel"] {
        width: 100%;
        box-sizing: border-box;
        padding: 14px;
        margin: 8px 0;
        border: 1px solid #ccc;
        border-radius: 8px;
        font-size: 20px;
        box-shadow: 0 3px 3px #F8694D;
        font-family: 'Louis George Cafe', Arial, sans-serif;
        font-weight: 500; 
    }

    .campo-senha {
        margin: 4px 0 0 0;
        font-size: 20px;
        color: #F8694D;
        text-align: left;
        position: relative;
    }

    .login {
        width: 100%;
        display: flex;
        justify-content: center;
    }

    .login p {
        text-align: center;
        margin-top: 30px;
        font-size: 21px;
    }

    .login a {
        color: #9EC662;
        text-decoration: none;
        font-size: 21px;
    }

    #validacao-senha {
        font-size: 16px; 
        margin-top: 8px; 
        line-height: 1.4;
    }

    .texto-valido { color: green; }
    .texto-invalido { color: red; }

    .campo-senha .icone-olho {
        cursor: pointer; 
        position: absolute; 
        right: 20px; 
        top: 30px; 
        color: #777;
    }

    </style>
</head>
<body>
    <div class="logo">
        <img src="img/Group 70.png" alt="Logo">
    </div>

    <div class="titulo">
        <p>Cadastro</p>
    </div>

    <div class="cadastro-form p-3" >
        <form class="row g-3" action="registrar_usuario.php" method="POST">

            <div class="col-5">
            <input type="text" id="nome" name="nome" placeholder="Informe seu nome completo" required>
            </div>

            <div class="col-md-4">
            <input type="text" id="username" name="username" placeholder="Escolha seu username" required>
            </div>

            <div class="col-md-4">
                <input type="email" id="email" name="email" placeholder="Informe seu e-mail" required>
            </div>

            <div class="col-md-6">
                <input type="text" id="email" name="confirmar_email" placeholder="Confirme seu e-mail" required>
            </div>

            <div class="campo-senha col-md-6">
                <input type="password" id="senha" name="senha" placeholder="Defina uma senha" required>
                <i class="fa-solid fa-eye icone-olho" id="toggleSenha"></i>
                
                <div id="validacao-senha">
                    <span id="val-tamanho" class="texto-invalido">❌ Mínimo de 6 caracteres</span><br>
                    <span id="val-numero" class="texto-invalido">❌ Pelo menos 1 número</span><br>
                    <span id="val-especial" class="texto-invalido">❌ Pelo menos 1 caractere especial</span>
                </div>
            </div>

            <div class="col-md-6 campo-senha">
                <input type="password" id="confirma-senha" name="confirmar_senha" placeholder="Confirme sua senha" required>
                <i class="fa-solid fa-eye icone-olho" id="toggleConfirmaSenha"></i>
            </div>
            
            <div class="col-12" style="width: 100%;">
                <div class="form-check" style="margin-top: 8px;">
                    <input class="form-check-input" type="checkbox" value="" id="invalidCheck2" required>
                    <label class="form-check-label" for="invalidCheck2" style="font-size: 18px;">
                        Concordo com os termos e condições
                    </label>
                </div>
            </div>

            <div class="botao col-12">
            <button type="submit">Cadastrar</button>
            <button type="button" onclick="window.location.href='login.html'">Cancelar</button>
            </div>

        </form>
        </div>
        
        <div class="login">
            <p>
                Já tem uma conta? <a href="login.html">Faça login</a>
            </p>
        </div>
</body>
<script>
    
    // --- SELETORES DE ELEMENTOS ---
    const formCadastro = document.querySelector("#form-cadastro");
    const inputEmail = document.querySelector("#email");
    const inputSenha = document.querySelector("#senha");
    const inputConfirmaSenha = document.querySelector("#confirma_senha");
    
    // Seletores do Olhinho
    const toggleSenha = document.querySelector("#toggleSenha");
    const toggleConfirmaSenha = document.querySelector("#toggleConfirmaSenha");

    // Seletores da Validação em Tempo Real
    const valTamanho = document.querySelector("#val-tamanho");
    const valNumero = document.querySelector("#val-numero");
    const valEspecial = document.querySelector("#val-especial");

    // FUNCIONALIDADE OLHINHO  ---
    
    // Função para alternar a visibilidade
    function alternarVisibilidade(input, icon) {
        const type = input.getAttribute("type") === "password" ? "text" : "password";
        input.setAttribute("type", type);
        
        // Muda o ícone (olho aberto / olho fechado)
        if (type === "password") {
            icon.classList.remove("fa-eye-slash"); // Remove ícone cortado
            icon.classList.add("fa-eye");       // Adiciona ícone aberto
        } else {
            icon.classList.remove("fa-eye");       // Remove ícone aberto
            icon.classList.add("fa-eye-slash"); // Adiciona ícone cortado
        }
    }

    // Adiciona o evento de clique ao primeiro olho
    toggleSenha.addEventListener("click", function() {
        alternarVisibilidade(inputSenha, toggleSenha);
    });

    // Adiciona o evento de clique ao segundo olho
    toggleConfirmaSenha.addEventListener("click", function() {
        alternarVisibilidade(inputConfirmaSenha, toggleConfirmaSenha);
    });

    // VALIDAÇÃO EM TEMPO REAL ---

    // Variáveis para guardar o estado da validação
    let temTamanho = false;
    let temNumero = false;
    let temEspecial = false;

    inputSenha.addEventListener("input", function() {
        const senha = inputSenha.value; 
        
        // Testa o Tamanho min
        if (senha.length >= 6) {
            valTamanho.textContent = "✅ Mínimo de 6 caracteres";
            valTamanho.className = "texto-valido";
            temTamanho = true;
        } else {
            valTamanho.textContent = "❌ Mínimo de 6 caracteres";
            valTamanho.className = "texto-invalido";
            temTamanho = false;
        }

        // Testa se tem Número
        if ( /\d/.test(senha) ) {
            valNumero.textContent = "✅ Pelo menos 1 número";
            valNumero.className = "texto-valido";
            temNumero = true;
        } else {
            valNumero.textContent = "❌ Pelo menos 1 número";
            valNumero.className = "texto-invalido";
            temNumero = false;
        }

        // Testa se tem Caractere Especial
        if ( /[!@#$%^&*(),.?":{}|<>]/.test(senha) ) {
            valEspecial.textContent = "✅ Pelo menos 1 caractere especial";
            valEspecial.className = "texto-valido";
            temEspecial = true;
        } else {
            valEspecial.textContent = "❌ Pelo menos 1 caractere especial";
            valEspecial.className = "texto-invalido";
            temEspecial = false;
        }
    });


    // ENVIO DO FORMULÁRIO (SUBMIT) ---
    
    formCadastro.addEventListener("submit", function(event) {
    event.preventDefault(); 
    
    // Pega os valores atuais
    const email = inputEmail.value;
    const senha = inputSenha.value;
    const confirmaSenha = inputConfirmaSenha.value;
    // (Pegue outros campos como 'nome', se precisar)

    // Senhas são iguais? 
    if (senha !== confirmaSenha) {
        alert("As senhas não coincidem.");
        return;
    } 
    
    // A senha cumpre os requisitos? 
    if (!temTamanho || !temNumero || !temEspecial) {
        alert("A sua senha não cumpre todos os requisitos.");
        return;
    }

    // Se as validações do JS passaram, envia para o PHP
    
    const formData = new FormData();
    formData.append('email_novo', email);
    formData.append('senha_nova', senha);
    // formData.append('nome_novo', nome); // Exemplo

    fetch('cadastro.php', { // O nome do seu script PHP de cadastro
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.sucesso) {
            alert("Cadastro realizado com sucesso! Você será redirecionado para o login.");
            window.location.href = 'login.html'; // Manda para o login
        } else {
            // Ex: PHP disse que o e-mail já existe
            alert(data.mensagem || "Ocorreu um erro no cadastro.");
        }
    })
    .catch(error => {
        console.error('Erro na requisição:', error);
        alert("Ocorreu um erro ao conectar com o servidor.");
    });
});

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</html>